/*! markov.js
Munaf Assaf (http://github.com/munaf)
Built 2013-10-15 */
(function(){var a="<<SENTENCE_START>>",b=function(a){return this.options={inputText:a.inputText,numWords:a.numWords||100,endWithCompleteSentence:!1},this.dictionary={},this._setup(),this};b.prototype={_setup:function(){this.dictionary[a]=[],this.dictionary["."]=[a],this.options.inputText&&this.addCorpus(this.options.inputText)},_randomNextWord:function(a){var b=this.dictionary[a];return b[Math.floor(Math.random()*b.length)]},_endsSentence:function(a){var b=a.slice(-1);return"."===b||"?"===b||"!"===b},_cleanText:function(a){return a=a.replace(/^\s+|\s+$/g,""),a.replace(/[^a-zA-Z\s.,!?:;]/g,"").replace(/\s{2,}/g," ")},_endsWithPunctuation:function(a){var b=a.slice(-1);return".,?!;:".indexOf(b)>-1},_capitalizeWord:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},_addWord:function(a,b){this.dictionary.hasOwnProperty(b)?a&&this.dictionary[b].push(a):this.dictionary[b]=a?[a]:[]},generate:function(b){for(var c,d="",e=a,f=0;b>f||this.options.endWithCompleteSentence===!0&&e!==a;)c=this._randomNextWord(e),this._endsWithPunctuation(c)?d+=c:e===a?(d+=" "+this._capitalizeWord(c),f++):c!==a&&(d+=" "+c,f++),e=c;return d},addCorpus:function(b){b=this._cleanText(b);for(var c,d=this,e=b.split(" "),f=[],g=a,h=0;h<e.length;h++)c=e[h].toLowerCase(),this._endsSentence(g)&&f.push(a),this._endsWithPunctuation(c)?(f.push(c.slice(0,c.length-1)),f.push(e[h].slice(-1))):f.push(c),f.forEach(function(a,b){var c=b>0?f[b-1]:g;d._addWord(a,c)}),g=f[f.length-1],f=[]}},window.Markov=b}).call(this);